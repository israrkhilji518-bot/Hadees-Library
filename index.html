<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hadees Library - Mobile Ready</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <style>
        :root { --primary: #004d40; --secondary: #c5a059; --bg: #f8f5f0; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; display: flex; height: 100vh; background: var(--bg); overflow: hidden; }

        /* Sidebar Responsive */
        .sidebar { width: 280px; background: #fff; border-right: 1px solid #ddd; display: flex; flex-direction: column; transition: 0.3s; z-index: 1000; }
        .sidebar-header { padding: 15px; background: var(--primary); color: white; display: flex; justify-content: space-between; align-items: center; }
        .chapter-list { flex-grow: 1; overflow-y: auto; padding: 10px; }
        
        /* Main View */
        .main-view { flex-grow: 1; display: flex; flex-direction: column; width: 100%; position: relative; }
        .top-nav { background: #fff; padding: 10px 15px; border-bottom: 1px solid #ddd; display: flex; align-items: center; gap: 10px; }
        
        /* Menu Button (Mobile Only) */
        .menu-btn { display: none; background: var(--primary); color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; }

        /* Admin Controls */
        .admin-panel { display: none; padding: 15px; background: #e0f2f1; border-bottom: 2px solid var(--secondary); max-height: 80vh; overflow-y: auto; }
        input, textarea, select { width: 100%; padding: 12px; margin: 5px 0; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        .btn-save { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; }

        /* Cards Style */
        .content-area { flex-grow: 1; padding: 15px; overflow-y: auto; }
        .hadees-card { background: #fff; padding: 20px; border-radius: 15px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border-left: 5px solid var(--secondary); }
        .arabic { font-size: 1.5rem; line-height: 1.8; text-align: right; direction: rtl; display: block; margin-bottom: 15px; color: #000; }
        .translation { font-size: 1.1rem; line-height: 1.5; }
        .urdu { text-align: right; direction: rtl; }
        .hindi { text-align: left; direction: ltr; color: #1a237e; }

        /* Mobile Adjustments */
        @media (max-width: 768px) {
            .sidebar { position: fixed; left: -280px; height: 100%; box-shadow: 2px 0 10px rgba(0,0,0,0.2); }
            .sidebar.active { left: 0; }
            .menu-btn { display: block; }
            .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999; }
            .overlay.active { display: block; }
            .arabic { font-size: 1.3rem; }
            .translation { font-size: 1rem; }
        }

        .book-title { font-weight: bold; background: #f0f0f0; padding: 10px; margin-top: 10px; border-radius: 5px; color: var(--primary); }
        .chapter-item { padding: 10px 15px; border-bottom: 1px solid #eee; cursor: pointer; font-size: 0.95rem; }
    </style>
</head>
<body>

<div class="overlay" id="overlay" onclick="toggleMenu()"></div>

<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <span>Hadees Menu</span>
        <button onclick="toggleMenu()" style="background:none; border:none; color:white; font-size:20px;">‚úï</button>
    </div>
    <div class="chapter-list" id="chapter-menu">
        <p style="text-align:center; padding:20px;">Loading...</p>
    </div>
    <button onclick="login()" id="loginBtn" style="padding:10px; background:#eee; border:none; cursor:pointer;">Admin Login</button>
</div>

<div class="main-view">
    <div class="top-nav">
        <button class="menu-btn" onclick="toggleMenu()">‚ò∞ Menu</button>
        <input type="text" id="search" onkeyup="searchFn()" placeholder="Yahan search karein..." style="margin:0; padding:8px 15px; border-radius:20px;">
    </div>

    <div id="admin-panel" class="admin-panel">
        <h4 style="margin:0 0 10px 0;">Nayi Hadees Dalein</h4>
        <input type="text" id="book-in" placeholder="Kitab (Bukhari, Muslim)">
        <input type="text" id="chap-in" placeholder="Chapter (Namaz, Roza)">
        <textarea id="arb-in" placeholder="Arabic..." rows="3" dir="rtl"></textarea>
        <select id="lang-sel">
            <option value="hindi">Hindi (‡§π‡§ø‡§Ç‡§¶‡•Ä)</option>
            <option value="urdu">Urdu (ÿßÿ±ÿØŸà)</option>
        </select>
        <textarea id="trans-in" placeholder="Translation..." rows="3"></textarea>
        <button class="btn-save" onclick="saveData()">Save to Global Library</button>
    </div>

    <div class="content-area" id="display-area">
        <h2 id="current-title" style="color:var(--primary); font-size:1.2rem;">Sari Hadees</h2>
        <div id="hadees-container"></div>
    </div>
</div>

<script>
    // --- Firebase Setup ---
    const firebaseConfig = {
        apiKey: "AIzaSyDkbnYW4pHJXwsFyWAtOR-R5I1hK5A4Gww",
        authDomain: "hadees-library-ea6a6.firebaseapp.com",
        databaseURL: "https://hadees-library-ea6a6-default-rtdb.firebaseio.com",
        projectId: "hadees-library-ea6a6",
        storageBucket: "hadees-library-ea6a6.firebasestorage.app",
        messagingSenderId: "741971433551",
        appId: "1:741971433551:web:68025b3aae4a4a265df23a"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let allData = {};
    let isAdmin = false;

    // Mobile Menu Toggle
    function toggleMenu() {
        document.getElementById('sidebar').classList.toggle('active');
        document.getElementById('overlay').classList.toggle('active');
    }

    function login() {
        if(prompt("Admin Password:") === "9950866474") {
            isAdmin = true;
            document.getElementById('admin-panel').style.display = 'block';
            document.getElementById('loginBtn').style.display = 'none';
            toggleMenu();
        }
    }

    function saveData() {
        const book = document.getElementById('book-in').value.trim();
        const chap = document.getElementById('chap-in').value.trim();
        const arb = document.getElementById('arb-in').value.trim();
        const trans = document.getElementById('trans-in').value.trim();
        const lang = document.getElementById('lang-sel').value;

        if(!book || !chap || !arb || !trans) return alert("Details bharein!");

        db.ref('hadees_v2').push({ book, chap, arb, trans, lang }).then(() => {
            alert("Save Ho Gaya!");
            document.getElementById('arb-in').value = "";
            document.getElementById('trans-in').value = "";
        });
    }

    db.ref('hadees_v2').on('value', (snapshot) => {
        allData = snapshot.val() || {};
        renderMenu();
        showChapter('all', 'Sari Hadees');
    });

    function renderMenu() {
        const menu = document.getElementById('chapter-menu');
        menu.innerHTML = '<div class="chapter-item" onclick="showChapter(\'all\', \'Sari Hadees\')">üè† Home (All)</div>';
        
        let groups = {};
        for(let id in allData) {
            let b = allData[id].book;
            if(!groups[b]) groups[b] = new Set();
            groups[b].add(allData[id].chap);
        }

        for(let book in groups) {
            menu.innerHTML += `<div class="book-title">üìö ${book}</div>`;
            groups[book].forEach(chap => {
                menu.innerHTML += `<div class="chapter-item" onclick="showChapter('${chap}', '${chap}')">${chap}</div>`;
            });
        }
    }

    function showChapter(chapName, title) {
        document.getElementById('current-title').innerText = title;
        const container = document.getElementById('hadees-container');
        container.innerHTML = "";

        for(let id in allData) {
            let h = allData[id];
            if(chapName === 'all' || h.chap === chapName) {
                container.innerHTML += `
                    <div class="hadees-card">
                        <small style="color:var(--secondary)">${h.book} / ${h.chap}</small>
                        <span class="arabic">${h.arb}</span>
                        <div class="translation ${h.lang === 'urdu' ? 'urdu' : 'hindi'}">${h.trans}</div>
                        ${isAdmin ? `<button onclick="deleteH('${id}')" style="color:red; margin-top:10px; border:none; background:none; cursor:pointer;">[Delete]</button>` : ''}
                    </div>`;
            }
        }
        if(window.innerWidth <= 768) toggleMenu();
    }

    function deleteH(id) { if(confirm("Mita dein?")) db.ref('hadees_v2/' + id).remove(); }

    function searchFn() {
        let q = document.getElementById('search').value.toLowerCase();
        document.querySelectorAll('.hadees-card').forEach(c => {
            c.innerText.toLowerCase().includes(q) ? c.style.display='block' : c.style.display='none';
        });
    }
</script>
</body>
</html>
