<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hadees Masail Library - Global</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <style>
        :root { --primary: #004d40; --secondary: #c5a059; --bg: #fdfaf5; }
        body { font-family: 'Arial', sans-serif; margin: 0; display: flex; height: 100vh; background: var(--bg); overflow: hidden; }
        .sidebar { width: 320px; background: #f1ede4; border-right: 2px solid #ddd; overflow-y: auto; padding: 20px; box-sizing: border-box; }
        .main-view { flex-grow: 1; display: flex; flex-direction: column; height: 100vh; }
        .admin-box { display: none; background: #fff; padding: 15px; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 20px; }
        input, textarea, select { width: 100%; padding: 10px; margin: 8px 0; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        .btn { padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; transition: 0.3s; background: var(--primary); color: white; }
        .hadees-card { background: white; padding: 20px; margin-bottom: 20px; border-radius: 12px; border-top: 5px solid var(--secondary); box-shadow: 0 4px 10px rgba(0,0,0,0.05); position: relative; }
        .arabic { font-size: 1.7rem; line-height: 2; display: block; text-align: right; direction: rtl; margin-bottom: 10px; }
        .lang-urdu { text-align: right; direction: rtl; font-size: 1.2rem; color: #333; }
        .lang-hindi { text-align: left; direction: ltr; font-size: 1.1rem; color: #1a237e; }
        .delete-btn { background: #ff5252; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; margin-top: 10px; display: none; }
        @media (max-width: 768px) { body { flex-direction: column; } .sidebar { width: 100%; height: auto; } }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2 style="color:var(--primary); text-align:center;">Islami Library</h2>
        <button id="loginBtn" onclick="login()" class="btn" style="margin-bottom:10px;">Admin Login</button>
        
        <div id="admin-panel" class="admin-box">
            <b>Admin Mode Active ✅</b>
            <input type="text" id="book-in" placeholder="Kitab (Bukhari, Muslim)">
            <input type="text" id="chap-in" placeholder="Chapter (Iman, Namaz)">
            <textarea id="arb-in" placeholder="Arabic Text..." rows="3" dir="rtl"></textarea>
            <select id="lang-sel">
                <option value="hindi">Hindi (हिंदी)</option>
                <option value="urdu">Urdu (اردو)</option>
            </select>
            <textarea id="trans-in" placeholder="Tarjuma (Translation)..." rows="3"></textarea>
            <button class="btn" onclick="saveToCloud()">Duniya ke liye Save Karein</button>
        </div>

        <input type="text" id="searchBox" onkeyup="search()" placeholder="Search library...">
    </div>

    <div class="main-view">
        <div id="hadees-list" style="overflow-y:auto; padding:20px;">
            <h3 style="text-align:center; color:#999; margin-top:50px;">Hadees Load ho rahi hain...</h3>
        </div>
    </div>

<script>
    // --- Aapka Firebase Config ---
    const firebaseConfig = {
        apiKey: "AIzaSyDkbnYW4pHJXwsFyWAtOR-R5I1hK5A4Gww",
        authDomain: "hadees-library-ea6a6.firebaseapp.com",
        databaseURL: "https://hadees-library-ea6a6-default-rtdb.firebaseio.com",
        projectId: "hadees-library-ea6a6",
        storageBucket: "hadees-library-ea6a6.firebasestorage.app",
        messagingSenderId: "741971433551",
        appId: "1:741971433551:web:68025b3aae4a4a265df23a"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let isAdmin = false;

    // Admin Login (9950866474)
    function login() {
        let p = prompt("Admin Password Dalein:");
        if(p === "9950866474") {
            isAdmin = true;
            document.getElementById('admin-panel').style.display = 'block';
            document.getElementById('loginBtn').style.display = 'none';
            document.querySelectorAll('.delete-btn').forEach(b => b.style.display = 'block');
        } else { alert("Ghalat Password!"); }
    }

    // Cloud Save Function
    function saveToCloud() {
        const book = document.getElementById('book-in').value;
        const chap = document.getElementById('chap-in').value;
        const arb = document.getElementById('arb-in').value;
        const trans = document.getElementById('trans-in').value;
        const lang = document.getElementById('lang-sel').value;

        if(!book || !arb || !trans) return alert("Sari details bharein!");

        db.ref('global_hadees').push({
            book, chapter: chap, arabic: arb, translation: trans, language: lang
        }).then(() => {
            alert("Mubarak ho! Data duniya ke liye save ho gaya.");
            document.getElementById('arb-in').value = "";
            document.getElementById('trans-in').value = "";
        });
    }

    // Real-time Update (Automatic sync)
    db.ref('global_hadees').on('value', (snapshot) => {
        const data = snapshot.val();
        const list = document.getElementById('hadees-list');
        list.innerHTML = "";
        for(let id in data) {
            let h = data[id];
            let delBtn = isAdmin ? `<button class="delete-btn" style="display:block" onclick="deleteHadees('${id}')">Delete</button>` : '';
            list.innerHTML += `
                <div class="hadees-card">
                    <small>${h.book} > ${h.chapter}</small>
                    <span class="arabic">${h.arabic}</span>
                    <div class="${h.language === 'urdu' ? 'lang-urdu' : 'lang-hindi'}">${h.translation}</div>
                    ${delBtn}
                </div>`;
        }
    });

    function deleteHadees(id) {
        if(confirm("Kya aap ise mitana chahte hain?")) db.ref('global_hadees/' + id).remove();
    }

    function search() {
        let q = document.getElementById('searchBox').value.toLowerCase();
        document.querySelectorAll('.hadees-card').forEach(card => {
            card.innerText.toLowerCase().includes(q) ? card.style.display = 'block' : card.style.display = 'none';
        });
    }
</script>
</body>
</html>
