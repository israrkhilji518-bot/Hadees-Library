<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hadees Library - Professional Edition</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <style>
        :root { --primary: #004d40; --secondary: #c5a059; --bg: #f4f1ea; --text: #2c3e50; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; background: var(--bg); color: var(--text); }

        /* Sidebar Navigation */
        .sidebar { width: 300px; background: #fff; border-right: 2px solid #e0e0e0; display: flex; flex-direction: column; }
        .sidebar-header { padding: 20px; background: var(--primary); color: white; text-align: center; }
        .chapter-list { flex-grow: 1; overflow-y: auto; padding: 10px; }
        .book-title { font-weight: bold; background: #eee; padding: 8px; margin-top: 10px; border-radius: 4px; color: var(--primary); cursor: pointer; }
        .chapter-item { padding: 8px 15px; cursor: pointer; border-bottom: 1px solid #f0f0f0; transition: 0.2s; font-size: 0.9rem; }
        .chapter-item:hover { background: #fff9c4; color: #000; }
        .active-chap { background: var(--secondary) !important; color: white !important; font-weight: bold; }

        /* Main Content */
        .main-view { flex-grow: 1; display: flex; flex-direction: column; }
        .top-bar { padding: 15px 25px; background: #fff; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; }
        .content-area { flex-grow: 1; padding: 30px; overflow-y: auto; }
        
        /* Admin Panel */
        .admin-panel { display: none; padding: 20px; background: #fff; border-bottom: 2px solid var(--secondary); }
        .input-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
        input, textarea, select { padding: 10px; border: 1px solid #ccc; border-radius: 5px; width: 100%; box-sizing: border-box; }
        .btn { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-save { background: var(--primary); color: white; }

        /* Cards */
        .hadees-card { background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; border-right: 6px solid var(--secondary); }
        .arabic { font-size: 1.8rem; line-height: 2.2; text-align: right; direction: rtl; display: block; margin-bottom: 15px; font-family: 'Amiri', serif; }
        .translation { font-size: 1.2rem; }
        .urdu { text-align: right; direction: rtl; color: #333; }
        .hindi { text-align: left; direction: ltr; color: #1a237e; }

        @media (max-width: 768px) { body { flex-direction: column; } .sidebar { width: 100%; height: 250px; } }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="sidebar-header">
        <h3>Hadees Library</h3>
        <button onclick="login()" id="loginBtn" style="font-size: 12px; cursor: pointer;">Admin Login</button>
    </div>
    <div class="chapter-list" id="chapter-menu">
        <p style="text-align:center; color:#999;">Loading Chapters...</p>
    </div>
</div>

<div class="main-view">
    <div id="admin-panel" class="admin-panel">
        <div class="input-row">
            <input type="text" id="book-in" placeholder="Kitab ka naam (e.g. Bukhari)">
            <input type="text" id="chap-in" placeholder="Chapter ka naam (e.g. Ilm)">
        </div>
        <textarea id="arb-in" placeholder="Arabic Text..." rows="2" dir="rtl"></textarea>
        <div class="input-row" style="margin-top:10px;">
            <select id="lang-sel">
                <option value="hindi">Hindi (‡§π‡§ø‡§Ç‡§¶‡•Ä)</option>
                <option value="urdu">Urdu (ÿßÿ±ÿØŸà)</option>
            </select>
            <button class="btn btn-save" onclick="saveData()">Duniya ke liye Save Karein</button>
        </div>
        <textarea id="trans-in" placeholder="Translation (Tarjuma)..." rows="2"></textarea>
    </div>

    <div class="top-bar">
        <h2 id="current-title">Sari Hadees</h2>
        <input type="text" id="search" onkeyup="searchFn()" placeholder="Search..." style="width:200px; padding:5px;">
    </div>

    <div class="content-area" id="display-area">
        </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyDkbnYW4pHJXwsFyWAtOR-R5I1hK5A4Gww",
        authDomain: "hadees-library-ea6a6.firebaseapp.com",
        databaseURL: "https://hadees-library-ea6a6-default-rtdb.firebaseio.com",
        projectId: "hadees-library-ea6a6",
        storageBucket: "hadees-library-ea6a6.firebasestorage.app",
        messagingSenderId: "741971433551",
        appId: "1:741971433551:web:68025b3aae4a4a265df23a"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let allData = {};
    let isAdmin = false;

    function login() {
        if(prompt("Password:") === "9950866474") {
            isAdmin = true;
            document.getElementById('admin-panel').style.display = 'block';
            document.getElementById('loginBtn').style.display = 'none';
        }
    }

    function saveData() {
        const book = document.getElementById('book-in').value.trim();
        const chap = document.getElementById('chap-in').value.trim();
        const arb = document.getElementById('arb-in').value.trim();
        const trans = document.getElementById('trans-in').value.trim();
        const lang = document.getElementById('lang-sel').value;

        if(!book || !chap || !arb || !trans) return alert("Puri jankari bharein!");

        db.ref('hadees_v2').push({ book, chap, arb, trans, lang, time: Date.now() })
        .then(() => {
            alert("Save ho gaya!");
            document.getElementById('arb-in').value = "";
            document.getElementById('trans-in').value = "";
        });
    }

    // Firebase se data lena aur grouping karna
    db.ref('hadees_v2').on('value', (snapshot) => {
        allData = snapshot.val() || {};
        renderMenu();
        showChapter('all', 'Sari Hadees');
    });

    function renderMenu() {
        const menu = document.getElementById('chapter-menu');
        menu.innerHTML = '<div class="chapter-item" onclick="showChapter(\'all\', \'Sari Hadees\')">üè† Sab dikhayein</div>';
        
        let groups = {};
        for(let id in allData) {
            let b = allData[id].book;
            let c = allData[id].chap;
            if(!groups[b]) groups[b] = new Set();
            groups[b].add(c);
        }

        for(let book in groups) {
            menu.innerHTML += `<div class="book-title">üìö ${book}</div>`;
            groups[book].forEach(chap => {
                menu.innerHTML += `<div class="chapter-item" onclick="showChapter('${chap}', '${book}: ${chap}')">‚îî ${chap}</div>`;
            });
        }
    }

    function showChapter(chapName, displayTitle) {
        document.getElementById('current-title').innerText = displayTitle;
        const display = document.getElementById('display-area');
        display.innerHTML = "";

        for(let id in allData) {
            let h = allData[id];
            if(chapName === 'all' || h.chap === chapName) {
                display.innerHTML += `
                    <div class="hadees-card">
                        <small style="color:var(--secondary)">${h.book} / ${h.chap}</small>
                        <span class="arabic">${h.arb}</span>
                        <div class="translation ${h.lang === 'urdu' ? 'urdu' : 'hindi'}">${h.trans}</div>
                        ${isAdmin ? `<button onclick="deleteH('${id}')" style="color:red; margin-top:10px; cursor:pointer;">Delete</button>` : ''}
                    </div>`;
            }
        }
    }

    function deleteH(id) {
        if(confirm("Mita dein?")) db.ref('hadees_v2/' + id).remove();
    }

    function searchFn() {
        let q = document.getElementById('search').value.toLowerCase();
        document.querySelectorAll('.hadees-card').forEach(c => {
            c.innerText.toLowerCase().includes(q) ? c.style.display='block' : c.style.display='none';
        });
    }
</script>
</body>
</html>
